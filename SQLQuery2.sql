use EVIDEO;
GO

/* NULL VALUES**/

SELECT * FROM DETAILRENTAL;

UPDATE DETAILRENTAL
SET DETAIL_DAILYLATEFEE = 12.03
WHERE VID_NUM = 61353;

SELECT * FROM DETAILRENTAL
WHERE DETAIL_DAILYLATEFEE 
IS NOT NULL 
AND DETAIL_RETURNDATE 
IS NOT NULL;

SELECT * FROM DETAILRENTAL
WHERE DETAIL_DAILYLATEFEE 
IS NULL OR 
DETAIL_RETURNDATE 
IS NULL;

/**DELETE CLAUSE*/
DELETE FROM DETAILRENTAL
WHERE RENT_NUM = 1009 AND DETAIL_FEE = 35.00;

INSERT INTO DETAILRENTAL
VALUES (1009, 34869, 35.00, '2020-03-05',' 2020-03-05',	30.00,	0);

SELECT TOP 4 * FROM DETAILRENTAL;

INSERT INTO DETAILRENTAL(RENT_NUM, VID_NUM, DETAIL_FEE, DETAIL_DUEDATE, DETAIL_RETURNDATE, DETAIL_DAILYLATEFEE, DETAIL_DAYSLATE)
VALUES 
(1, 101, 50.00, '2025-01-01', '2025-01-05', 5.00, 2),
(2, 102, 45.00, '2025-01-02', '2025-01-06', 4.50, 1),
(3, 103, 60.00, '2025-01-03', '2025-01-07', 6.00, 3),
(4, 104, 55.00, '2025-01-04', '2025-01-08', 5.50, 0),
(5, 105, 65.00, '2025-01-05', '2025-01-09', 6.50, 4),
(6, 106, 40.00, '2025-01-06', '2025-01-10', 4.00, 1),
(7, 107, 70.00, '2025-01-07', '2025-01-11', 7.00, 3),
(8, 108, 75.00, '2025-01-08', '2025-01-12', 7.50, 2),
(9, 109, 80.00, '2025-01-09', '2025-01-13', 8.00, 1),
(10, 110, 85.00, '2025-01-10', '2025-01-14', 8.50, 2),
(11, 111, 90.00, '2025-01-11', '2025-01-15', 9.00, 0),
(12, 112, 95.00, '2025-01-12', '2025-01-16', 9.50, 4),
(13, 113, 100.00, '2025-01-13', '2025-01-17', 10.00, 3),
(14, 114, 105.00, '2025-01-14', '2025-01-18', 10.50, 2),
(15, 115, 110.00, '2025-01-15', '2025-01-19', 11.00, 1),
(16, 116, 115.00, '2025-01-16', '2025-01-20', 11.50, 0);


SELECT * FROM DETAILRENTAL
ORDER BY RENT_NUM DESC;

/**AGGREGATE MIN()*/
SELECT MIN(DETAIL_FEE)
FROM DETAILRENTAL;

/**AGGREGATE MAX()*/
SELECT MAX(DETAIL_FEE)
FROM DETAILRENTAL;

/**AGGREGATE COUNT() */
SELECT COUNT(VID_NUM)
FROM DETAILRENTAL;

SELECT COUNT(DETAIL_FEE)
FROM DETAILRENTAL
WHERE DETAIL_FEE < 50;

SELECT COUNT(DISTINCT DETAIL_DAYSLATE)
FROM DETAILRENTAL;

/**AGGREGATE SUM()*/
SELECT SUM(DETAIL_FEE)
FROM DETAILRENTAL;

SELECT SUM(DETAIL_DAILYLATEFEE)
FROM DETAILRENTAL
WHERE DETAIL_FEE < 50;
